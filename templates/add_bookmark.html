{% extends 'base.html' %}
{% block page_title %}افزودن بوکمارک{% endblock %}
{% block content %}
<div class="card">
  <div class="card-body">
    <form method="POST" novalidate>
      {{ form.hidden_tag() }}
      <div class="row g-3">
        <div class="col-md-6">
          {{ form.name.label }}
          {{ form.name(class='form-control', placeholder='مثلاً: پنل مدیریت') }}
          {% for e in form.name.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
        </div>
        <div class="col-md-6">
          {{ form.url.label }}
          {{ form.url(class='form-control', id='url', placeholder='مثلاً: http://example.com') }}
          {% for e in form.url.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
        </div>
        <div class="col-md-6">
          {{ form.address.label }}
          {{ form.address(class='form-control', placeholder='مثلاً: 192.168.1.10 یا domain.local') }}
          {% for e in form.address.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
        </div>
        <div class="col-md-6">
          {{ form.port.label }}
          {{ form.port(class='form-control', placeholder='مثلاً: 8080') }}
          {% for e in form.port.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
        </div>
        <div class="col-12">
          {{ form.description.label }}
          {{ form.description(class='form-control') }}
          {% for e in form.description.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
        </div>
        <div class="col-12 form-check">{{ form.is_favorite(class='form-check-input') }} {{ form.is_favorite.label(class='form-check-label') }}</div>
      </div>
      <div class="mt-3">
        {{ form.submit(class='btn btn-primary') }}
        <a href="{{ url_for('bookmarks') }}" class="btn btn-secondary">برگشت</a>
      </div>
    </form>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function(){
  const form = document.querySelector('form');
  form.addEventListener('submit', function(){
    const urlInput = document.getElementById('url');
    if (urlInput && urlInput.value && !/^https?:\/\//i.test(urlInput.value)) {
      urlInput.value = 'http://' + urlInput.value;
    }
  });
});
</script>
{% endblock %}