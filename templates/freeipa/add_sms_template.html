{% extends "base.html" %}

{% block title %}افزودن قالب پیامک{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="page-header">
                <h1><i class="fas fa-plus"></i> افزودن قالب پیامک</h1>
                <p class="text-muted">ایجاد قالب جدید برای ارسال پیامک</p>
            </div>
        </div>
    </div>

    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h5><i class="fas fa-sms"></i> اطلاعات قالب</h5>
                </div>
                <div class="card-body">
                    <form method="POST">
                        <div class="form-group">
                            <label for="name">نام قالب <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="name" name="name" required
                                   placeholder="مثال: password_notification" value="{{ request.form.get('name', '') }}">
                            <small class="form-text text-muted">نام منحصر به فرد برای قالب</small>
                        </div>

                        <div class="form-group">
                            <label for="template">قالب پیامک <span class="text-danger">*</span></label>
                            <textarea class="form-control" id="template" name="template" rows="6" required
                                      placeholder="مثال: کاربر گرامی {fullname}، نام کاربری: {username}، رمز عبور: {password}">{{ request.form.get('template', '') }}</textarea>
                            <small class="form-text text-muted">
                                از متغیرهای زیر استفاده کنید:
                                <ul class="list-unstyled mt-2">
                                    <li><code>{username}</code> - نام کاربری</li>
                                    <li><code>{password}</code> - رمز عبور</li>
                                    <li><code>{fullname}</code> - نام کامل</li>
                                    <li><code>{email}</code> - ایمیل</li>
                                    <li><code>{mobile}</code> - شماره موبایل</li>
                                </ul>
                            </small>
                        </div>

                        <div class="form-group">
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="is_active" name="is_active" checked>
                                <label class="form-check-label" for="is_active">
                                    <i class="fas fa-power-off"></i> قالب فعال
                                </label>
                            </div>
                            <small class="form-text text-muted">قالب‌های غیرفعال در لیست انتخاب نمایش داده نمی‌شوند</small>
                        </div>

                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> ذخیره قالب
                            </button>
                            <a href="{{ url_for('freeipa_sms_templates') }}" class="btn btn-secondary">
                                <i class="fas fa-times"></i> انصراف
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- راهنما -->
    <div class="row mt-4">
        <div class="col-md-8 mx-auto">
            <div class="card">
                <div class="card-header">
                    <h6><i class="fas fa-info-circle"></i> راهنمای قالب‌سازی</h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6>متغیرهای قابل استفاده:</h6>
                            <ul class="list-unstyled">
                                <li><code>{username}</code> - نام کاربری FreeIPA</li>
                                <li><code>{password}</code> - رمز عبور تولید شده</li>
                                <li><code>{fullname}</code> - نام کامل کاربر</li>
                                <li><code>{email}</code> - آدرس ایمیل</li>
                                <li><code>{mobile}</code> - شماره موبایل</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6>نکات مهم:</h6>
                            <ul class="list-unstyled">
                                <li><i class="fas fa-check text-success"></i> از متغیرها در آکولاد استفاده کنید</li>
                                <li><i class="fas fa-check text-success"></i> پیامک باید کوتاه و واضح باشد</li>
                                <li><i class="fas fa-check text-success"></i> حداکثر 160 کاراکتر توصیه می‌شود</li>
                                <li><i class="fas fa-check text-success"></i> از کاراکترهای فارسی پشتیبانی می‌شود</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.card {
    border: none;
    border-radius: 15px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    backdrop-filter: blur(20px);
    background: rgba(255, 255, 255, 0.95);
}

.card-header {
    background: rgba(255, 255, 255, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    border-radius: 15px 15px 0 0;
}

.form-group label {
    font-weight: 600;
    color: #2d3748;
    margin-bottom: 0.5rem;
}

.form-control {
    border-radius: 10px;
    border: 2px solid #e2e8f0;
    padding: 0.75rem 1rem;
    transition: all 0.3s ease;
}

.form-control:focus {
    border-color: #667eea;
    box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
}

.form-check {
    margin-bottom: 0.5rem;
}

.form-check-input {
    margin-top: 0.25rem;
}

.form-actions {
    margin-top: 2rem;
    padding-top: 1rem;
    border-top: 1px solid #e2e8f0;
}

.btn {
    border-radius: 10px;
    padding: 0.75rem 1.5rem;
    font-weight: 500;
    transition: all 0.3s ease;
}

.btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.text-danger {
    color: #e53e3e !important;
}

code {
    background: rgba(0, 0, 0, 0.1);
    padding: 0.2rem 0.4rem;
    border-radius: 4px;
    font-family: 'Courier New', monospace;
}
</style>
{% endblock %}
